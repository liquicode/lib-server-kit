extends ../index.pug

block content

	script( type='text/javascript' src='/storage/item.js' )

	div( ng-controller='StorageItem_Controller' )

		script
			!= `window.SERVER_DATA = {};\n`
			!= `window.SERVER_DATA.User = ${JSON.stringify( locals.User )};\n`
			!= `window.SERVER_DATA.ItemDefinition = ${JSON.stringify(locals.ItemDefinition)};\n`
			!= `window.SERVER_DATA.ServiceDefinition = ${JSON.stringify( locals.ServiceDefinition)};\n`
			!= `window.SERVER_DATA.Parameters = "${locals.Parameters}";\n`


		//-=====================================================================
		//-=====================================================================
		//- 
		//- 	Page Header
		//- 
		//-=====================================================================
		//-=====================================================================


		.w3-container.w3-blue-grey
			h2
				i
					span( ng-show="Page.PageOp === 'Create'" ) New {{Page.ItemDefinition.title}}
					span( ng-show="Page.PageOp === 'Read'" ) View {{Page.ItemDefinition.title}}
					span( ng-show="Page.PageOp === 'Update'" ) Update {{Page.ItemDefinition.title}}
					span( ng-show="Page.PageOp === 'Delete'" ) Delete {{Page.ItemDefinition.title}}


		.w3-container


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	List Navigation
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				a.w3-btn.w3-white.w3-border.w3-small.w3-padding-small(
					ng-href="/ui/{{Page.ServiceDefinition.name}}/List"
					ng-show="[ 'admin', 'super' ].includes( Page.User.user_role )" 
				)
					i.fa.fa-angle-double-left.w3-padding-small
					span {{ Page.ItemDefinition.titles }}

				br
				//- .w3-panel.w3-sand.w3-margin-small


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Object Info
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section

				div(
					ng-click="Page.object_info_visible = !Page.object_info_visible"
				).w3-btn.w3-tag.w3-small.w3-white.w3-border.w3-round-large Metadata

				div(
					ng-show="Page.object_info_visible"
				).w3-container.w3-white.w3-border.w3-round-large
					pre {{Page.ItemInfo()}}


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Page Buttons
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				a.w3-btn.w3-green.w3-border.w3-small.w3-padding-small(
					ng-click="Page.CreateItem()"
					ng-show="Page.PageOp === 'Create'"
				) Create This {{ Page.ItemDefinition.title }}
				a.w3-btn.w3-blue.w3-border.w3-small.w3-padding-small(
					ng-click="Page.WriteItem()"
					ng-show="Page.PageOp === 'Update'"
				) Update This {{ Page.ItemDefinition.title }}
				a.w3-btn.w3-red.w3-border.w3-small.w3-padding-small(
					ng-click="Page.DeleteItem()"
					ng-show="Page.PageOp === 'Delete'"
				) Delete This {{ Page.ItemDefinition.title }}
				.w3-container.w3-margin


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Storage Item
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				.w3-border.w3-round-large.w3-white(
					ng-repeat="field in Page.ItemDefinition.Fields"
				)

					.w3-row

						.w3-quarter.w3-padding-small
							h5.w3-center {{ field.title }} :

						.w3-threequarter.w3-padding-small

							.w3-row
								.w3-small {{ field.description }}

							.w3-row

								span( ng-show="!Page.IsFieldEditable( field )" )

									.w3-text-blue( ng-bind="Page.Item[field.name]" )

								span( ng-show="Page.IsFieldEditable( field )" )

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'string'"
										ng-model="Page.Item[field.name]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'date'"
										ng-model="Page.Item[field.name]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'url'"
										ng-model="Page.Item[field.name]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'image_url'"
										ng-model="Page.Item[field.name]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'number'"
										ng-model="Page.Item[field.name]"
									)

									.w3-text-blue(
										ng-show="field.type === 'array'"
									) {{ Page.Item[field.name].length }} items

									.w3-text-blue(
										ng-show="field.type === 'object'"
									) {{ JSON.stringify( Page.Item[field.name] ) }}


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Page Buttons
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				.w3-container.w3-margin
				a.w3-btn.w3-green.w3-border.w3-small.w3-padding-small(
					ng-click="Page.CreateItem()"
					ng-show="Page.PageOp === 'Create'"
				) Create This {{ Page.ItemDefinition.title }}
				a.w3-btn.w3-blue.w3-border.w3-small.w3-padding-small(
					ng-click="Page.WriteItem()"
					ng-show="Page.PageOp === 'Update'"
				) Update This {{ Page.ItemDefinition.title }}
				a.w3-btn.w3-yellow.w3-border.w3-small.w3-padding-small(
					ng-href="{{Page.ItemSharingUrl()}}"
					ng-show="Page.PageOp === 'Update' && Page.ItemDefinition.shareable"
				) Share This {{ Page.ItemDefinition.title }}
				a.w3-btn.w3-red.w3-border.w3-small.w3-padding-small(
					ng-click="Page.DeleteItem()"
					ng-show="Page.PageOp === 'Delete'"
				) Delete This {{ Page.ItemDefinition.title }}


