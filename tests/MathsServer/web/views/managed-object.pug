extends index.pug

block content

	script( type='text/javascript' src='/managed-object.js' )

	div( ng-controller='ManagedObject_Controller' )

		script
			!= `window.SERVER_DATA = {};\n`
			!= `window.SERVER_DATA.User = ${JSON.stringify( locals.User )};\n`
			!= `window.SERVER_DATA.ObjectDefinition = ${JSON.stringify(locals.ObjectDefinition)};\n`
			!= `window.SERVER_DATA.Interface = ${JSON.stringify( locals.Interface)};\n`
			!= `window.SERVER_DATA.PageFunction = "${locals.PageFunction}";\n`
			!= `window.SERVER_DATA.ObjectID = "${locals.ObjectID}";\n`


		//-=====================================================================
		//-=====================================================================
		//- 
		//- 	Page Header
		//- 
		//-=====================================================================
		//-=====================================================================


		.w3-container.w3-blue-grey
			h2
				i
					span( ng-show="Page.Server.PageFunction === 'CreateOne'" ) New {{Page.Def.ObjectTitle}}
					span( ng-show="Page.Server.PageFunction === 'ReadOne'" ) View {{Page.Def.ObjectTitle}}
					span( ng-show="Page.Server.PageFunction === 'WriteOne'" ) Update {{Page.Def.ObjectTitle}}
					span( ng-show="Page.Server.PageFunction === 'DeleteOne'" ) Delete {{Page.Def.ObjectTitle}}


		.w3-container


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	List Navigations
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				a.w3-small(
					ng-href="/{{Page.Def.ServiceName}}/ListMine"
					ng-show="[ 'admin', 'super', 'user' ].includes( Page.Server.User.role )" 
				)
					i.fa.fa-angle-left.w3-padding-small
					span Return to: My {{ Page.Def.ServiceTitle }}
				br
				a.w3-small(
					ng-href="/{{Page.Def.ServiceName}}/ListAll"
					ng-show="[ 'admin', 'super' ].includes( Page.Server.User.role )" 
				)
					i.fa.fa-angle-double-left.w3-padding-small
					span Go to: All {{ Page.Def.ServiceTitle }}
				br
				//- .w3-panel.w3-sand.w3-margin-small


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Object Info
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section

				div(
					ng-click="Page.object_info_visible = !Page.object_info_visible"
				).w3-btn.w3-tag.w3-small.w3-white.w3-border.w3-round-large Metadata

				div(
					ng-show="Page.object_info_visible"
				).w3-container.w3-white.w3-border.w3-round-large
					table 
						tr 
							th.w3-right ID:
							td {{ Page.object._m.id }}
						tr 
							th.w3-right Created:
							td {{ Page.object._m.created_at }}
						tr 
							th.w3-right Updated:
							td {{ Page.object._m.updated_at }}
						tr 
							th.w3-right Owner:
							td {{ Page.object._m.owner.name }} ({{ Page.object._m.owner.email }})
						tr 
							th.w3-right Partners:
							td 
								div(
									ng-repeat="partner in Page.object._m.partners"
								) {{ partner.name }} ({{ partner.email }})


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Page Buttons
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				a.w3-btn.w3-green.w3-border.w3-small.w3-padding-small(
					ng-click="Page.CreateObject()"
					ng-show="Page.Server.PageFunction === 'CreateOne'"
				) Create This {{ Page.Def.ObjectTitle }}
				a.w3-btn.w3-blue.w3-border.w3-small.w3-padding-small(
					ng-click="Page.WriteObject()"
					ng-show="Page.Server.PageFunction === 'WriteOne'"
				) Update This {{ Page.Def.ObjectTitle }}
				a.w3-btn.w3-red.w3-border.w3-small.w3-padding-small(
					ng-click="Page.DeleteObject()"
					ng-show="Page.Server.PageFunction === 'DeleteOne'"
				) Delete This {{ Page.Def.ObjectTitle }}
				.w3-container.w3-margin


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Managed Object
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				.w3-border.w3-round-large.w3-white(
					ng-repeat="field in Page.Def.Fields"
				)

					.w3-row

						.w3-quarter.w3-padding-small
							h5.w3-center {{ field.title }} :

						.w3-threequarter.w3-padding-small

							.w3-row
								.w3-small {{ field.description }}

							.w3-row

								span( ng-show="Page.IsReadOnly()" )

									.w3-text-blue( ng-bind="Page.object[field.member]" )

								span( ng-show="!Page.IsReadOnly()" )

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'string'"
										ng-model="Page.object[field.member]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'date'"
										ng-model="Page.object[field.member]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'url'"
										ng-model="Page.object[field.member]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'image_url'"
										ng-model="Page.object[field.member]"
									)

									input.w3-input.w3-sand.w3-round-large.w3-text-blue(
										type="text"
										ng-show="field.type === 'number'"
										ng-model="Page.object[field.member]"
									)

									.w3-text-blue(
										ng-show="field.type === 'array'"
									) {{ Page.object[field.member].length }} items

									.w3-text-blue(
										ng-show="field.type === 'object'"
									) {{ JSON.stringify( Page.object[field.member] ) }}


			//-=====================================================================
			//-=====================================================================
			//- 
			//- 	Page Buttons
			//- 
			//-=====================================================================
			//-=====================================================================


			.w3-section
				.w3-container.w3-margin
				a.w3-btn.w3-green.w3-border.w3-small.w3-padding-small(
					ng-click="Page.CreateObject()"
					ng-show="Page.Server.PageFunction === 'CreateOne'"
				) Create This {{ Page.Def.ObjectTitle }}
				a.w3-btn.w3-blue.w3-border.w3-small.w3-padding-small(
					ng-click="Page.WriteObject()"
					ng-show="Page.Server.PageFunction === 'WriteOne'"
				) Update This {{ Page.Def.ObjectTitle }}
				a.w3-btn.w3-red.w3-border.w3-small.w3-padding-small(
					ng-click="Page.DeleteObject()"
					ng-show="Page.Server.PageFunction === 'DeleteOne'"
				) Delete This {{ Page.Def.ObjectTitle }}


